# OOPS 用户指南

**OOPS - One-click Operating Pre-check System (一键运行预检系统)**

> 让游戏脚本运行更顺畅 | Run Your Game Scripts Smoothly

## 🚀 两种使用方式

### 方式1: 放到项目根目录（推荐）⭐

**最简单的使用方式！**

1. 将 `oops.exe` 复制到你的项目根目录
   ```
   D:\ZZZ-OD\
   ├── oops.exe          ← 放这里
   ├── src\
   ├── config\
   └── ...
   ```

2. 双击运行 `oops.exe`

3. 程序会自动：
   - ✅ 检测当前目录是什么项目
   - ✅ 自动配置检测项
   - ✅ 运行诊断
   - ✅ 生成报告
   - ✅ 在浏览器中打开报告

**示例输出**:
```
[*] 🎯 自动检测到项目: 绝区零一条龙
[*] 📁 项目路径: D:\ZZZ-OD
[*] 🚀 开始自动诊断...
```

---

### 方式2: 独立运行

1. 将 `oops.exe` 放在任意位置

2. 双击运行或使用命令行：
   ```bash
   oops.exe
   ```

3. 程序会：
   - 列出所有配置的项目
   - 让你选择要检测的项目
   - 运行诊断并生成报告

---

## 📊 理解检测报告

### 控制台输出

运行后会显示：

```
[*] 检测完成!
   [+] 成功: 3 项
   [-] 失败: 0 项
   [!] 问题: 2 个
   [%] 成功率: 100.0%

============================================================
发现 2 个需要关注的问题
============================================================

1. ❌ [错误] path_validation
   具体问题:
   • path_exists: 路径不存在: D:/ZZZ-OD
   💡 建议: 请确保项目安装路径存在且正确

2. ⚠️ [警告] environment_dependencies
   💡 建议: 建议使用虚拟环境隔离项目依赖
```

### 问题级别说明

| 图标 | 级别 | 说明 | 是否需要处理 |
|------|------|------|--------------|
| 🔴 | 严重 | 必须立即处理，否则无法运行 | ✅ 必须 |
| ❌ | 错误 | 需要处理，可能导致运行失败 | ✅ 建议 |
| ⚠️ | 警告 | 建议处理，可能影响性能或稳定性 | 💡 可选 |
| ℹ️ | 信息 | 仅供参考 | ❌ 无需 |

### HTML报告

程序会自动在浏览器中打开详细的HTML报告，包含：

- 📊 检测摘要（成功率、问题统计）
- 🔍 详细检测结果（每项检测的具体信息）
- 💡 修复建议汇总（按类别分组）
- 📈 可视化图表

报告保存在 `reports/` 目录下。

---

## 🎯 支持的项目

OOPS 可以自动检测以下项目：

### 绝区零一条龙
**检测标识**:
- `zzz_od` 目录
- `OneDragon-Launcher.exe`
- `src/zzz_od` 目录

**检测项**:
- ✅ 网络连通性（GitHub、Gitee、PyPI源）
- ✅ 环境依赖（Python版本、虚拟环境、系统库）
- ✅ 路径规范（中文路径、空格、权限）
- ✅ 米哈游API连通性
- ✅ GitHub代理可用性

### MAA明日方舟助手
**检测标识**:
- `MAA.exe`
- `MaaCore.dll`
- `resource` 目录

### OK鸣潮脚本
**检测标识**:
- `ok-ww` 目录
- `wuthering` 相关文件

---

## 🔧 常见问题

### Q1: 为什么没有检测到我的项目？

**A**: 确保你的项目包含特征文件：
- 绝区零：需要有 `zzz_od` 目录或 `OneDragon-Launcher.exe`
- MAA：需要有 `MAA.exe` 或 `MaaCore.dll`

如果还是检测不到，可以手动指定：
```bash
oops.exe --project zenless_zone_zero
```

### Q2: 检测到的路径不对怎么办？

**A**: 程序会自动扫描当前目录和父目录（最多3层）。如果检测错误：
1. 将 `oops.exe` 移动到正确的项目根目录
2. 或使用命令行指定配置文件

### Q3: 如何只检测特定项目？

**A**: 使用命令行参数：
```bash
# 检测指定项目
oops.exe --project zenless_zone_zero

# 列出所有可用项目
oops.exe --list-projects
```

### Q4: 报告保存在哪里？

**A**: 报告保存在 `reports/` 目录下，文件名格式：
```
oops_report_项目名_时间戳.html
```

例如：
```
reports/oops_report_zenless_zone_zero_20241122_001417.html
```

### Q5: 如何不自动打开浏览器？

**A**: 使用 `--no-browser` 参数：
```bash
oops.exe --no-browser
```

### Q6: 如何查看详细日志？

**A**: 使用 `--verbose` 参数：
```bash
oops.exe --verbose
```

详细日志会显示：
- 每个检测步骤的详细信息
- 基于知识库的解决方案推荐
- 调试信息

所有日志也会保存到 `oops.log` 文件。

---

## 💡 使用技巧

### 技巧1: 定期检测

建议每周运行一次检测，及时发现潜在问题：
```bash
# 每周一运行
oops.exe
```

### 技巧2: 安装前检测

在安装新项目前，先运行检测确保环境满足要求：
```bash
# 检测环境
oops.exe --quick-scan
```

### 技巧3: 问题排查

遇到问题时，使用详细模式获取更多信息：
```bash
# 详细模式
oops.exe --verbose
```

### 技巧4: 保存报告

重要的检测报告建议备份：
```bash
# 生成所有格式报告
oops.exe --report-format all
```

会生成：
- HTML报告（可视化）
- JSON报告（程序处理）
- Markdown报告（文档归档）

---

## 📞 获取帮助

### 查看帮助信息
```bash
oops.exe --help
```

### 查看版本
```bash
oops.exe --version
```

### 问题反馈

如果遇到问题：
1. 查看 `oops.log` 日志文件
2. 使用 `--verbose` 模式重新运行
3. 提交问题到 GitHub Issues

---

## 🎨 输出示例

### 成功案例
```
[*] 🎯 自动检测到项目: 绝区零一条龙
[*] 📁 项目路径: D:\ZZZ-OD
[*] 🚀 开始自动诊断...

[*] 检测完成!
   [+] 成功: 5 项
   [-] 失败: 0 项
   [!] 问题: 0 个
   [%] 成功率: 100.0%

✅ 所有检测通过！项目环境正常。

📄 HTML报告已生成: reports\oops_report_zenless_zone_zero_20241122_001417.html
🌐 已在浏览器中打开报告
```

### 发现问题案例
```
[*] 检测完成!
   [+] 成功: 3 项
   [-] 失败: 0 项
   [!] 问题: 2 个
   [%] 成功率: 100.0%

============================================================
发现 2 个需要关注的问题
============================================================

1. ❌ [错误] network_connectivity
   具体问题:
   • https://github.com/...: SSL certificate verify failed
   💡 建议: 配置Git SSL后端或使用Gitee镜像

2. ⚠️ [警告] path_validation
   具体问题:
   • 路径包含中文字符
   💡 建议: 使用纯英文路径，例如: D:\ZZZ-OD

============================================================
💡 详细信息请查看HTML报告
============================================================
```

---

---

## 📖 相关文档

### 用户文档
- 🏠 **[返回主页](README.md)** - 项目介绍
- 🚀 **[快速开始](QUICKSTART.md)** - 一分钟上手
- ⚙️ **[命令行手册](USAGE.md)** - 高级用法和参数说明
- 📝 **[更新日志](CHANGELOG.md)** - 版本历史

### 开发者文档
- 🔧 **[开发者指南](docs/dev/DEVELOPER_GUIDE.md)** - 参与开发
- 📚 **[文档索引](docs/README.md)** - 完整文档列表

### 获取帮助
- 🐛 **[报告问题](https://github.com/idk500/OOPS/issues)** - GitHub Issues
- 💬 **[讨论交流](https://github.com/idk500/OOPS/discussions)** - GitHub Discussions

---

**祝你使用愉快！** 🎉
